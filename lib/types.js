(function() {
  'use strict';
  var Bounded_list, SFMODULES, Type, Typespace, _test_monotony, debug, hide, nameit, regex, rpr, set_getter, type_of;

  //===========================================================================================================
  SFMODULES = require('bricabrac-single-file-modules');

  ({type_of} = SFMODULES.unstable.require_type_of());

  ({
    show_no_colors: rpr
  } = SFMODULES.unstable.require_show());

  ({debug} = console);

  ({regex} = require('regex'));

  ({hide, set_getter} = SFMODULES.require_managed_property_tools());

  ({nameit} = SFMODULES.require_nameit());

  Bounded_list = (function() {
    //===========================================================================================================
    /* NOTE Future Single-File Module */
    class Bounded_list {
      //---------------------------------------------------------------------------------------------------------
      constructor(max_size = 3) {
        this.max_size = max_size;
        this.data = [];
        return void 0;
      }

      //---------------------------------------------------------------------------------------------------------
      create(...P) {
        this.data.push(Object.assign({}, ...P));
        if (this.size > this.max_size) {
          this.data.shift();
        }
        return this.current;
      }

      //---------------------------------------------------------------------------------------------------------
      at(idx) {
        return this.data.at(idx);
      }

    };

    //---------------------------------------------------------------------------------------------------------
    set_getter(Bounded_list.prototype, 'size', function() {
      return this.data.length;
    });

    set_getter(Bounded_list.prototype, 'is_empty', function() {
      return this.data.length === 0;
    });

    set_getter(Bounded_list.prototype, 'current', function() {
      if (this.is_empty) {
        return this.create();
      } else {
        return this.at(-1);
      }
    });

    return Bounded_list;

  }).call(this);

  //===========================================================================================================
  /* NOTE Future Single-File Module */
  Type = class Type {
    //---------------------------------------------------------------------------------------------------------
    constructor(typespace, name, isa) {
      var create_data;
      hide(this, 'name', name);
      hide(this, 'T', typespace);
      hide(this, '_isa', isa);
      this.data = new Bounded_list();
      create_data = (...P) => {
        return this.data.create(...P);
      };
      hide(this, '_ctx', {
        T: typespace,
        me: this,
        create_data
      });
      return void 0;
    }

    //---------------------------------------------------------------------------------------------------------
    isa(x) {
      return this._isa.call(this._ctx, x);
    }

  };

  //===========================================================================================================
  _test_monotony = function(x, data, cmp) {
    var R, chr, chrs, i, idx, prv_chr, ref;
    ({chrs} = data);
    if (chrs.length === 0) {
      return false;
    }
    if (chrs.length === 1) {
      return true;
    }
    for (idx = i = 1, ref = chrs.length; (1 <= ref ? i < ref : i > ref); idx = 1 <= ref ? ++i : --i) {
      prv_chr = chrs[idx - 1];
      chr = chrs[idx];
      R = (function() {
        switch (cmp) {
          case '>':
            return prv_chr > chr;
          case '<':
            return prv_chr < chr;
          default:
            throw new Error(`Î©bsk___8 (internal) expected '>' or '<', got ${rpr(cmp)}`);
        }
      })();
      if (R) {
        continue;
      }
      data.fail = {x, idx, prv_chr, chr};
      return false;
    }
    return true;
  };

  //===========================================================================================================
  Typespace = class Typespace {
    //---------------------------------------------------------------------------------------------------------
    constructor() {
      var Typeclass, clasz, i, isa, len, name, ref;
      clasz = this.constructor;
      ref = Object.getOwnPropertyNames(clasz);
      for (i = 0, len = ref.length; i < len; i++) {
        name = ref[i];
        Typeclass = class Typeclass extends Type {};
        nameit(name, Typeclass);
        this[name] = new Typeclass(this, name, isa = clasz[name]);
      }
      return void 0;
    }

    //=========================================================================================================
    static text(x) {
      return (type_of(x)) === 'text';
    }

    static nonempty_text(x) {
      return (this.T.text.isa(x)) && x.length > 0;
    }

    static float(x) {
      return Number.isFinite(x);
    }

    static integer(x) {
      return Number.isSafeInteger(x);
    }

    static pinteger(x) {
      return (this.T.integer.isa(x)) && x > 0;
    }

    static zpinteger(x) {
      return (this.T.integer.isa(x)) && x >= 0;
    }

    static cardinal(x) {
      return this.T.zpinteger.isa(x);
    }

    //---------------------------------------------------------------------------------------------------------
    static dimension(x) {
      return this.T.pinteger.isa(x);
    }

    //---------------------------------------------------------------------------------------------------------
    static incremental_text(x) {
      var data;
      if (!this.T.text.isa(x)) {
        return false;
      }
      data = this.create_data({
        chrs: Array.from(x)
      });
      return _test_monotony(x, data, '<');
    }

    //---------------------------------------------------------------------------------------------------------
    static decremental_text(x) {
      var data;
      if (!this.T.text.isa(x)) {
        return false;
      }
      data = this.create_data({
        chrs: Array.from(x)
      });
      return _test_monotony(x, data, '>');
    }

    //---------------------------------------------------------------------------------------------------------
    static nmag_bare_reversed(x) {
      if (!this.T.nonempty_text(x)) {
        return false;
      }
    }

    //---------------------------------------------------------------------------------------------------------
    static pmag_bare(x) {}

    //---------------------------------------------------------------------------------------------------------
    static magnifiers(x) {
      var nmag, nmag_bare_reversed, pmag, pmag_bare;
      if (!this.T.nonempty_text.isa(x)) {
        return false;
      }
      [nmag_bare_reversed, pmag_bare] = x.split(/\s+/v);
      if (!this.T.nmag_bare_reversed.isa(nmag_bare_reversed)) {
        return false;
      }
      if (!this.T.pmag_bare.isa(pmag_bare)) {
        return false;
      }
      nmag = ' ' + nmag_bare_reversed.reverse();
      return pmag = ' ' + pmag_bare;
    }

  };

  //===========================================================================================================
  module.exports = {
    types: new Typespace(),
    internals: {Type, Typespace, Bounded_list}
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL3R5cGVzLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQTtFQUFBO0FBQUEsTUFBQSxZQUFBLEVBQUEsU0FBQSxFQUFBLElBQUEsRUFBQSxTQUFBLEVBQUEsY0FBQSxFQUFBLEtBQUEsRUFBQSxJQUFBLEVBQUEsTUFBQSxFQUFBLEtBQUEsRUFBQSxHQUFBLEVBQUEsVUFBQSxFQUFBLE9BQUE7OztFQUdBLFNBQUEsR0FBNEIsT0FBQSxDQUFRLCtCQUFSOztFQUM1QixDQUFBLENBQUUsT0FBRixDQUFBLEdBQTRCLFNBQVMsQ0FBQyxRQUFRLENBQUMsZUFBbkIsQ0FBQSxDQUE1Qjs7RUFDQSxDQUFBO0lBQUUsY0FBQSxFQUFnQjtFQUFsQixDQUFBLEdBQTRCLFNBQVMsQ0FBQyxRQUFRLENBQUMsWUFBbkIsQ0FBQSxDQUE1Qjs7RUFDQSxDQUFBLENBQUUsS0FBRixDQUFBLEdBQTRCLE9BQTVCOztFQUNBLENBQUEsQ0FBRSxLQUFGLENBQUEsR0FBNEIsT0FBQSxDQUFRLE9BQVIsQ0FBNUI7O0VBQ0EsQ0FBQSxDQUFFLElBQUYsRUFDRSxVQURGLENBQUEsR0FDNEIsU0FBUyxDQUFDLDhCQUFWLENBQUEsQ0FENUI7O0VBRUEsQ0FBQSxDQUFFLE1BQUYsQ0FBQSxHQUE0QixTQUFTLENBQUMsY0FBVixDQUFBLENBQTVCOztFQUtNOzs7SUFBTixNQUFBLGFBQUEsQ0FBQTs7TUFHRSxXQUFhLENBQUUsV0FBVyxDQUFiLENBQUE7UUFDWCxJQUFDLENBQUEsUUFBRCxHQUFjO1FBQ2QsSUFBQyxDQUFBLElBQUQsR0FBYztBQUNkLGVBQU87TUFISSxDQURmOzs7TUFPRSxNQUFRLENBQUEsR0FBRSxDQUFGLENBQUE7UUFDTixJQUFDLENBQUEsSUFBSSxDQUFDLElBQU4sQ0FBVyxNQUFNLENBQUMsTUFBUCxDQUFjLENBQUEsQ0FBZCxFQUFrQixHQUFBLENBQWxCLENBQVg7UUFDQSxJQUFpQixJQUFDLENBQUEsSUFBRCxHQUFRLElBQUMsQ0FBQSxRQUExQjtVQUFBLElBQUMsQ0FBQSxJQUFJLENBQUMsS0FBTixDQUFBLEVBQUE7O0FBQ0EsZUFBTyxJQUFDLENBQUE7TUFIRixDQVBWOzs7TUFhRSxFQUFJLENBQUUsR0FBRixDQUFBO2VBQ0YsSUFBQyxDQUFBLElBQUksQ0FBQyxFQUFOLENBQVMsR0FBVDtNQURFOztJQWZOOzs7SUFtQkUsVUFBQSxDQUFXLFlBQUMsQ0FBQSxTQUFaLEVBQWdCLE1BQWhCLEVBQTRCLFFBQUEsQ0FBQSxDQUFBO2FBQUcsSUFBQyxDQUFBLElBQUksQ0FBQztJQUFULENBQTVCOztJQUNBLFVBQUEsQ0FBVyxZQUFDLENBQUEsU0FBWixFQUFnQixVQUFoQixFQUE0QixRQUFBLENBQUEsQ0FBQTthQUFHLElBQUMsQ0FBQSxJQUFJLENBQUMsTUFBTixLQUFnQjtJQUFuQixDQUE1Qjs7SUFDQSxVQUFBLENBQVcsWUFBQyxDQUFBLFNBQVosRUFBZ0IsU0FBaEIsRUFBNEIsUUFBQSxDQUFBLENBQUE7TUFBRyxJQUFHLElBQUMsQ0FBQSxRQUFKO2VBQWtCLElBQUMsQ0FBQSxNQUFELENBQUEsRUFBbEI7T0FBQSxNQUFBO2VBQWlDLElBQUMsQ0FBQSxFQUFELENBQUksQ0FBQyxDQUFMLEVBQWpDOztJQUFILENBQTVCOzs7O2dCQXBDRjs7OztFQXlDTSxPQUFOLE1BQUEsS0FBQSxDQUFBOztJQUdFLFdBQWEsQ0FBRSxTQUFGLEVBQWEsSUFBYixFQUFtQixHQUFuQixDQUFBO0FBQ2YsVUFBQTtNQUFJLElBQUEsQ0FBSyxJQUFMLEVBQVEsTUFBUixFQUFrQixJQUFsQjtNQUNBLElBQUEsQ0FBSyxJQUFMLEVBQVEsR0FBUixFQUFrQixTQUFsQjtNQUNBLElBQUEsQ0FBSyxJQUFMLEVBQVEsTUFBUixFQUFrQixHQUFsQjtNQUNBLElBQUMsQ0FBQSxJQUFELEdBQWtCLElBQUksWUFBSixDQUFBO01BQ2xCLFdBQUEsR0FBa0IsQ0FBQSxHQUFFLENBQUYsQ0FBQSxHQUFBO2VBQVksSUFBQyxDQUFBLElBQUksQ0FBQyxNQUFOLENBQWEsR0FBQSxDQUFiO01BQVo7TUFDbEIsSUFBQSxDQUFLLElBQUwsRUFBUSxNQUFSLEVBQWtCO1FBQUUsQ0FBQSxFQUFHLFNBQUw7UUFBZ0IsRUFBQSxFQUFJLElBQXBCO1FBQXVCO01BQXZCLENBQWxCO0FBQ0EsYUFBTztJQVBJLENBRGY7OztJQVdFLEdBQUssQ0FBRSxDQUFGLENBQUE7YUFBUyxJQUFDLENBQUEsSUFBSSxDQUFDLElBQU4sQ0FBVyxJQUFDLENBQUEsSUFBWixFQUFrQixDQUFsQjtJQUFUOztFQWJQLEVBekNBOzs7RUEwREEsY0FBQSxHQUFpQixRQUFBLENBQUUsQ0FBRixFQUFLLElBQUwsRUFBVyxHQUFYLENBQUE7QUFDakIsUUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLElBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLE9BQUEsRUFBQTtJQUFFLENBQUEsQ0FBRSxJQUFGLENBQUEsR0FBWSxJQUFaO0lBQ0EsSUFBaUIsSUFBSSxDQUFDLE1BQUwsS0FBZSxDQUFoQztBQUFBLGFBQU8sTUFBUDs7SUFDQSxJQUFpQixJQUFJLENBQUMsTUFBTCxLQUFlLENBQWhDO0FBQUEsYUFBTyxLQUFQOztJQUNBLEtBQVcsMEZBQVg7TUFDRSxPQUFBLEdBQVUsSUFBSSxDQUFFLEdBQUEsR0FBTSxDQUFSO01BQ2QsR0FBQSxHQUFVLElBQUksQ0FBRSxHQUFGO01BQ2QsQ0FBQTtBQUFVLGdCQUFPLEdBQVA7QUFBQSxlQUNILEdBREc7bUJBQ00sT0FBQSxHQUFVO0FBRGhCLGVBRUgsR0FGRzttQkFFTSxPQUFBLEdBQVU7QUFGaEI7WUFHSCxNQUFNLElBQUksS0FBSixDQUFVLENBQUEsNkNBQUEsQ0FBQSxDQUFnRCxHQUFBLENBQUksR0FBSixDQUFoRCxDQUFBLENBQVY7QUFISDs7TUFJVixJQUFZLENBQVo7QUFBQSxpQkFBQTs7TUFDQSxJQUFJLENBQUMsSUFBTCxHQUFZLENBQUUsQ0FBRixFQUFLLEdBQUwsRUFBVSxPQUFWLEVBQW1CLEdBQW5CO0FBQ1osYUFBTztJQVRUO0FBVUEsV0FBTztFQWRRLEVBMURqQjs7O0VBNEVNLFlBQU4sTUFBQSxVQUFBLENBQUE7O0lBR0UsV0FBYSxDQUFBLENBQUE7QUFDZixVQUFBLFNBQUEsRUFBQSxLQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBO01BQUksS0FBQSxHQUFRLElBQUMsQ0FBQTtBQUNUO01BQUEsS0FBQSxxQ0FBQTs7UUFDUSxZQUFOLE1BQUEsVUFBQSxRQUF3QixLQUF4QixDQUFBO1FBQ0EsTUFBQSxDQUFPLElBQVAsRUFBYSxTQUFiO1FBQ0EsSUFBQyxDQUFFLElBQUYsQ0FBRCxHQUFZLElBQUksU0FBSixDQUFjLElBQWQsRUFBaUIsSUFBakIsRUFBdUIsR0FBQSxHQUFNLEtBQUssQ0FBRSxJQUFGLENBQWxDO01BSGQ7QUFJQSxhQUFPO0lBTkksQ0FEZjs7O0lBVW1CLE9BQWhCLElBQWdCLENBQUUsQ0FBRixDQUFBO2FBQVMsQ0FBRSxPQUFBLENBQVEsQ0FBUixDQUFGLENBQUEsS0FBaUI7SUFBMUI7O0lBQ0EsT0FBaEIsYUFBZ0IsQ0FBRSxDQUFGLENBQUE7YUFBUyxDQUFFLElBQUMsQ0FBQSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQVIsQ0FBWSxDQUFaLENBQUYsQ0FBQSxJQUFzQixDQUFDLENBQUMsTUFBRixHQUFXO0lBQTFDOztJQUNBLE9BQWhCLEtBQWdCLENBQUUsQ0FBRixDQUFBO2FBQVMsTUFBTSxDQUFDLFFBQVAsQ0FBZ0IsQ0FBaEI7SUFBVDs7SUFDQSxPQUFoQixPQUFnQixDQUFFLENBQUYsQ0FBQTthQUFTLE1BQU0sQ0FBQyxhQUFQLENBQXFCLENBQXJCO0lBQVQ7O0lBQ0EsT0FBaEIsUUFBZ0IsQ0FBRSxDQUFGLENBQUE7YUFBUyxDQUFFLElBQUMsQ0FBQSxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQVgsQ0FBZSxDQUFmLENBQUYsQ0FBQSxJQUF5QixDQUFBLEdBQUk7SUFBdEM7O0lBQ0EsT0FBaEIsU0FBZ0IsQ0FBRSxDQUFGLENBQUE7YUFBUyxDQUFFLElBQUMsQ0FBQSxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQVgsQ0FBZSxDQUFmLENBQUYsQ0FBQSxJQUF5QixDQUFBLElBQUs7SUFBdkM7O0lBQ0EsT0FBaEIsUUFBZ0IsQ0FBRSxDQUFGLENBQUE7YUFBUyxJQUFDLENBQUEsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFiLENBQWlCLENBQWpCO0lBQVQsQ0FoQm5COzs7SUFrQm1CLE9BQWhCLFNBQWdCLENBQUUsQ0FBRixDQUFBO2FBQVMsSUFBQyxDQUFBLENBQUMsQ0FBQyxRQUFRLENBQUMsR0FBWixDQUFpQixDQUFqQjtJQUFULENBbEJuQjs7O0lBcUJxQixPQUFsQixnQkFBa0IsQ0FBRSxDQUFGLENBQUE7QUFDckIsVUFBQTtNQUFJLEtBQW9CLElBQUMsQ0FBQSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQVIsQ0FBWSxDQUFaLENBQXBCO0FBQUEsZUFBTyxNQUFQOztNQUNBLElBQUEsR0FBTyxJQUFDLENBQUEsV0FBRCxDQUFhO1FBQUUsSUFBQSxFQUFRLEtBQUssQ0FBQyxJQUFOLENBQVcsQ0FBWDtNQUFWLENBQWI7QUFDUCxhQUFPLGNBQUEsQ0FBZSxDQUFmLEVBQWtCLElBQWxCLEVBQXdCLEdBQXhCO0lBSFUsQ0FyQnJCOzs7SUEyQnFCLE9BQWxCLGdCQUFrQixDQUFFLENBQUYsQ0FBQTtBQUNyQixVQUFBO01BQUksS0FBb0IsSUFBQyxDQUFBLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBUixDQUFZLENBQVosQ0FBcEI7QUFBQSxlQUFPLE1BQVA7O01BQ0EsSUFBQSxHQUFPLElBQUMsQ0FBQSxXQUFELENBQWE7UUFBRSxJQUFBLEVBQVEsS0FBSyxDQUFDLElBQU4sQ0FBVyxDQUFYO01BQVYsQ0FBYjtBQUNQLGFBQU8sY0FBQSxDQUFlLENBQWYsRUFBa0IsSUFBbEIsRUFBd0IsR0FBeEI7SUFIVSxDQTNCckI7OztJQWlDdUIsT0FBcEIsa0JBQW9CLENBQUUsQ0FBRixDQUFBO01BQ25CLEtBQW9CLElBQUMsQ0FBQSxDQUFDLENBQUMsYUFBSCxDQUFpQixDQUFqQixDQUFwQjtBQUFBLGVBQU8sTUFBUDs7SUFEbUIsQ0FqQ3ZCOzs7SUFxQ2MsT0FBWCxTQUFXLENBQUUsQ0FBRixDQUFBLEVBQUEsQ0FyQ2Q7OztJQXdDZSxPQUFaLFVBQVksQ0FBRSxDQUFGLENBQUE7QUFDZixVQUFBLElBQUEsRUFBQSxrQkFBQSxFQUFBLElBQUEsRUFBQTtNQUFJLEtBQW9CLElBQUMsQ0FBQSxDQUFDLENBQUMsYUFBYSxDQUFDLEdBQWpCLENBQXFCLENBQXJCLENBQXBCO0FBQUEsZUFBTyxNQUFQOztNQUNBLENBQUUsa0JBQUYsRUFDRSxTQURGLENBQUEsR0FDa0IsQ0FBQyxDQUFDLEtBQUYsQ0FBUSxNQUFSO01BQ2xCLEtBQW9CLElBQUMsQ0FBQSxDQUFDLENBQUMsa0JBQWtCLENBQUMsR0FBdEIsQ0FBMEIsa0JBQTFCLENBQXBCO0FBQUEsZUFBTyxNQUFQOztNQUNBLEtBQW9CLElBQUMsQ0FBQSxDQUFDLENBQUMsU0FBUyxDQUFDLEdBQWIsQ0FBMEIsU0FBMUIsQ0FBcEI7QUFBQSxlQUFPLE1BQVA7O01BQ0EsSUFBQSxHQUFrQixHQUFBLEdBQU0sa0JBQWtCLENBQUMsT0FBbkIsQ0FBQTthQUN4QixJQUFBLEdBQWtCLEdBQUEsR0FBTTtJQVBiOztFQTFDZixFQTVFQTs7O0VBaUlBLE1BQU0sQ0FBQyxPQUFQLEdBQWlCO0lBQUUsS0FBQSxFQUFPLElBQUksU0FBSixDQUFBLENBQVQ7SUFBMEIsU0FBQSxFQUFXLENBQUUsSUFBRixFQUFRLFNBQVIsRUFBbUIsWUFBbkI7RUFBckM7QUFqSWpCIiwic291cmNlc0NvbnRlbnQiOlsiXG4ndXNlIHN0cmljdCdcblxuIz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5TRk1PRFVMRVMgICAgICAgICAgICAgICAgID0gcmVxdWlyZSAnYnJpY2FicmFjLXNpbmdsZS1maWxlLW1vZHVsZXMnXG57IHR5cGVfb2YsICAgICAgICAgICAgICB9ID0gU0ZNT0RVTEVTLnVuc3RhYmxlLnJlcXVpcmVfdHlwZV9vZigpXG57IHNob3dfbm9fY29sb3JzOiBycHIsICB9ID0gU0ZNT0RVTEVTLnVuc3RhYmxlLnJlcXVpcmVfc2hvdygpXG57IGRlYnVnLCAgICAgICAgICAgICAgICB9ID0gY29uc29sZVxueyByZWdleCwgICAgICAgICAgICAgICAgfSA9IHJlcXVpcmUgJ3JlZ2V4J1xueyBoaWRlLFxuICBzZXRfZ2V0dGVyLCAgICAgICAgICAgfSA9IFNGTU9EVUxFUy5yZXF1aXJlX21hbmFnZWRfcHJvcGVydHlfdG9vbHMoKVxueyBuYW1laXQsICAgICAgICAgICAgICAgfSA9IFNGTU9EVUxFUy5yZXF1aXJlX25hbWVpdCgpXG5cblxuIz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4jIyMgTk9URSBGdXR1cmUgU2luZ2xlLUZpbGUgTW9kdWxlICMjI1xuY2xhc3MgQm91bmRlZF9saXN0XG5cbiAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBjb25zdHJ1Y3RvcjogKCBtYXhfc2l6ZSA9IDMgKSAtPlxuICAgIEBtYXhfc2l6ZSAgID0gbWF4X3NpemVcbiAgICBAZGF0YSAgICAgICA9IFtdXG4gICAgcmV0dXJuIHVuZGVmaW5lZFxuXG4gICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY3JlYXRlOiAoIFAuLi4gKSAtPlxuICAgIEBkYXRhLnB1c2ggT2JqZWN0LmFzc2lnbiB7fSwgUC4uLlxuICAgIEBkYXRhLnNoaWZ0KCkgaWYgQHNpemUgPiBAbWF4X3NpemVcbiAgICByZXR1cm4gQGN1cnJlbnRcblxuICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIGF0OiAoIGlkeCApIC0+XG4gICAgQGRhdGEuYXQgaWR4XG5cbiAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBzZXRfZ2V0dGVyIEA6OiwgJ3NpemUnLCAgICAgLT4gQGRhdGEubGVuZ3RoXG4gIHNldF9nZXR0ZXIgQDo6LCAnaXNfZW1wdHknLCAtPiBAZGF0YS5sZW5ndGggaXMgMFxuICBzZXRfZ2V0dGVyIEA6OiwgJ2N1cnJlbnQnLCAgLT4gaWYgQGlzX2VtcHR5IHRoZW4gQGNyZWF0ZSgpIGVsc2UgQGF0IC0xXG5cblxuIz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4jIyMgTk9URSBGdXR1cmUgU2luZ2xlLUZpbGUgTW9kdWxlICMjI1xuY2xhc3MgVHlwZVxuXG4gICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY29uc3RydWN0b3I6ICggdHlwZXNwYWNlLCBuYW1lLCBpc2EgKSAtPlxuICAgIGhpZGUgQCwgJ25hbWUnLCAgIG5hbWVcbiAgICBoaWRlIEAsICdUJywgICAgICB0eXBlc3BhY2VcbiAgICBoaWRlIEAsICdfaXNhJywgICBpc2FcbiAgICBAZGF0YSAgICAgICAgICAgPSBuZXcgQm91bmRlZF9saXN0KClcbiAgICBjcmVhdGVfZGF0YSAgICAgPSAoIFAuLi4gKSA9PiBAZGF0YS5jcmVhdGUgUC4uLlxuICAgIGhpZGUgQCwgJ19jdHgnLCAgIHsgVDogdHlwZXNwYWNlLCBtZTogQCwgY3JlYXRlX2RhdGEsIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkXG5cbiAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBpc2E6ICggeCApIC0+IEBfaXNhLmNhbGwgQF9jdHgsIHhcblxuXG4jPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbl90ZXN0X21vbm90b255ID0gKCB4LCBkYXRhLCBjbXAgKSAtPlxuICB7IGNocnMsIH0gPSBkYXRhXG4gIHJldHVybiBmYWxzZSAgaWYgY2hycy5sZW5ndGggaXMgMFxuICByZXR1cm4gdHJ1ZSAgIGlmIGNocnMubGVuZ3RoIGlzIDFcbiAgZm9yIGlkeCBpbiBbIDEgLi4uIGNocnMubGVuZ3RoIF1cbiAgICBwcnZfY2hyID0gY2hyc1sgaWR4IC0gMSBdXG4gICAgY2hyICAgICA9IGNocnNbIGlkeCAgICAgXVxuICAgIFIgICAgICAgPSBzd2l0Y2ggY21wXG4gICAgICB3aGVuICc+JyB0aGVuIHBydl9jaHIgPiBjaHJcbiAgICAgIHdoZW4gJzwnIHRoZW4gcHJ2X2NociA8IGNoclxuICAgICAgZWxzZSB0aHJvdyBuZXcgRXJyb3IgXCLOqWJza19fXzggKGludGVybmFsKSBleHBlY3RlZCAnPicgb3IgJzwnLCBnb3QgI3tycHIgY21wfVwiXG4gICAgY29udGludWUgaWYgUlxuICAgIGRhdGEuZmFpbCA9IHsgeCwgaWR4LCBwcnZfY2hyLCBjaHIsIH1cbiAgICByZXR1cm4gZmFsc2VcbiAgcmV0dXJuIHRydWVcblxuXG4jPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmNsYXNzIFR5cGVzcGFjZVxuXG4gICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY29uc3RydWN0b3I6IC0+XG4gICAgY2xhc3ogPSBAY29uc3RydWN0b3JcbiAgICBmb3IgbmFtZSBpbiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyBjbGFzelxuICAgICAgY2xhc3MgVHlwZWNsYXNzIGV4dGVuZHMgVHlwZVxuICAgICAgbmFtZWl0IG5hbWUsIFR5cGVjbGFzc1xuICAgICAgQFsgbmFtZSBdID0gbmV3IFR5cGVjbGFzcyBALCBuYW1lLCBpc2EgPSBjbGFzelsgbmFtZSBdXG4gICAgcmV0dXJuIHVuZGVmaW5lZFxuXG4gICM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgQHRleHQ6ICAgICAgICAgICAoIHggKSAtPiAoIHR5cGVfb2YgeCApIGlzICd0ZXh0J1xuICBAbm9uZW1wdHlfdGV4dDogICggeCApIC0+ICggQFQudGV4dC5pc2EgeCApIGFuZCB4Lmxlbmd0aCA+IDBcbiAgQGZsb2F0OiAgICAgICAgICAoIHggKSAtPiBOdW1iZXIuaXNGaW5pdGUgeFxuICBAaW50ZWdlcjogICAgICAgICggeCApIC0+IE51bWJlci5pc1NhZmVJbnRlZ2VyIHhcbiAgQHBpbnRlZ2VyOiAgICAgICAoIHggKSAtPiAoIEBULmludGVnZXIuaXNhIHggKSBhbmQgeCA+IDBcbiAgQHpwaW50ZWdlcjogICAgICAoIHggKSAtPiAoIEBULmludGVnZXIuaXNhIHggKSBhbmQgeCA+PSAwXG4gIEBjYXJkaW5hbDogICAgICAgKCB4ICkgLT4gQFQuenBpbnRlZ2VyLmlzYSB4XG4gICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgQGRpbWVuc2lvbjogICAgICAoIHggKSAtPiBAVC5waW50ZWdlci5pc2EgIHhcblxuICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIEBpbmNyZW1lbnRhbF90ZXh0OiAoIHggKSAtPlxuICAgIHJldHVybiBmYWxzZSB1bmxlc3MgQFQudGV4dC5pc2EgeFxuICAgIGRhdGEgPSBAY3JlYXRlX2RhdGEgeyBjaHJzOiAoIEFycmF5LmZyb20geCksIH1cbiAgICByZXR1cm4gX3Rlc3RfbW9ub3RvbnkgeCwgZGF0YSwgJzwnXG5cbiAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBAZGVjcmVtZW50YWxfdGV4dDogKCB4ICkgLT5cbiAgICByZXR1cm4gZmFsc2UgdW5sZXNzIEBULnRleHQuaXNhIHhcbiAgICBkYXRhID0gQGNyZWF0ZV9kYXRhIHsgY2hyczogKCBBcnJheS5mcm9tIHgpLCB9XG4gICAgcmV0dXJuIF90ZXN0X21vbm90b255IHgsIGRhdGEsICc+J1xuXG4gICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgQG5tYWdfYmFyZV9yZXZlcnNlZDogKCB4ICkgLT5cbiAgICByZXR1cm4gZmFsc2UgdW5sZXNzIEBULm5vbmVtcHR5X3RleHQgeFxuXG4gICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgQHBtYWdfYmFyZTogKCB4ICkgLT5cblxuICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIEBtYWduaWZpZXJzOiAoIHggKSAtPlxuICAgIHJldHVybiBmYWxzZSB1bmxlc3MgQFQubm9uZW1wdHlfdGV4dC5pc2EgeFxuICAgIFsgbm1hZ19iYXJlX3JldmVyc2VkLFxuICAgICAgcG1hZ19iYXJlLCAgXSA9IHguc3BsaXQgL1xccysvdlxuICAgIHJldHVybiBmYWxzZSB1bmxlc3MgQFQubm1hZ19iYXJlX3JldmVyc2VkLmlzYSBubWFnX2JhcmVfcmV2ZXJzZWRcbiAgICByZXR1cm4gZmFsc2UgdW5sZXNzIEBULnBtYWdfYmFyZS5pc2EgICAgICAgICAgcG1hZ19iYXJlXG4gICAgbm1hZyAgICAgICAgICAgID0gJyAnICsgbm1hZ19iYXJlX3JldmVyc2VkLnJldmVyc2UoKVxuICAgIHBtYWcgICAgICAgICAgICA9ICcgJyArIHBtYWdfYmFyZVxuXG5cbiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxubW9kdWxlLmV4cG9ydHMgPSB7IHR5cGVzOiBuZXcgVHlwZXNwYWNlKCksIGludGVybmFsczogeyBUeXBlLCBUeXBlc3BhY2UsIEJvdW5kZWRfbGlzdCwgfSwgfVxuIl19
