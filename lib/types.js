(function() {
  'use strict';
  var CFG, Hollerith_typespace, SFMODULES, Type, Typespace, _test_monotony, debug, freeze, rpr, type_of;

  //===========================================================================================================
  SFMODULES = require('../../bricabrac-single-file-modules');

  ({type_of} = SFMODULES.unstable.require_type_of());

  ({
    show_no_colors: rpr
  } = SFMODULES.unstable.require_show());

  ({debug} = console);

  // { regex,                } = require 'regex'
  ({freeze} = Object);

  ({Type, Typespace, CFG} = SFMODULES.unstable.require_nanotypes());

  Hollerith_typespace = (function() {
    //###########################################################################################################
    // HOLLERITH TYPESPACE
    //===========================================================================================================
    class Hollerith_typespace extends Typespace {
      //=========================================================================================================
      static text(x) {
        return (type_of(x)) === 'text';
      }

      static nonempty_text(x) {
        return (this.T.text.isa(x)) && (x.length > 0);
      }

      static character(x) {
        return (this.T.text.isa(x)) && (/^.$/v.test(x));
      }

      static float(x) {
        return Number.isFinite(x);
      }

      static integer(x) {
        return Number.isSafeInteger(x);
      }

      static pinteger(x) {
        return (this.T.integer.isa(x)) && (x > 0);
      }

      static zpinteger(x) {
        return (this.T.integer.isa(x)) && (x >= 0);
      }

      static cardinal(x) {
        return this.T.zpinteger.isa(x);
      }

      //---------------------------------------------------------------------------------------------------------
      /* NOTE requiring `x` to be both a character and equal to `@[CFG].blank` means `@[CFG].blank` itself can be tested */
      static blank(x) {
        return (this.T.character.isa(x)) && (x === this[CFG].blank);
      }

      static dimension(x) {
        return this.T.pinteger.isa(x);
      }

      //---------------------------------------------------------------------------------------------------------
      static incremental_text(x) {
        if (!this.T.text.isa(x)) {
          return false;
        }
        this.assign({
          chrs: freeze(Array.from(x))
        });
        return _test_monotony.call(this, x, '<');
      }

      //---------------------------------------------------------------------------------------------------------
      static decremental_text(x) {
        if (!this.T.text.isa(x)) {
          return false;
        }
        this.assign({
          chrs: freeze(Array.from(x))
        });
        return _test_monotony.call(this, x, '>');
      }

      //---------------------------------------------------------------------------------------------------------
      static nmag_bare_reversed(x) {
        return this.T.incremental_text.isa(x, this.data);
      }

      static pmag_bare(x) {
        return this.T.incremental_text.isa(x, this.data);
      }

      //---------------------------------------------------------------------------------------------------------
      static magnifiers(x) {
        var nmag, nmag_bare_reversed, pmag, pmag_bare;
        if (!this.T.nonempty_text.isa(x)) {
          return this.fail("expected a magnifier, got an empty text");
        }
        [nmag_bare_reversed, pmag_bare] = x.split(this[CFG].blank);
        if (!this.T.nmag_bare_reversed.isa(nmag_bare_reversed, this.data, {
          chrs: 'nmag_chrs_reversed'
        })) {
          //.......................................................................................................
          // @assign { iam: 'magnifiers', }; debug 'Ωbsk___1', @data
          return this.fail("Ωbsk___2 ???");
        }
        if (!this.T.pmag_bare.isa(pmag_bare, this.data, {
          chrs: 'pmag_chrs'
        })) {
          return this.fail("Ωbsk___3 ???");
        }
        if (!this.T.incremental_text.isa(nmag_bare_reversed + pmag_bare)) {
          return this.fail("Ωbsk___4 ???");
        }
        //.......................................................................................................
        nmag = this[CFG].blank + [...this.data.nmag_chrs_reversed].reverse().join('');
        pmag = this[CFG].blank + pmag_bare;
        this.assign({nmag, pmag});
        return true;
      }

      //---------------------------------------------------------------------------------------------------------
      static alphabet(x) {
        if (!this.T.incremental_text.isa(x, this.data, {
          chrs: 'alphabet_chrs'
        })) {
          return false;
        }
        if (!(this.data.alphabet_chrs.length >= 2)) {
          // debug 'Ωbsk___5', @data
          return this.fail("an alphabet must have 2 chrs or more");
        }
        return true;
      }

    };

    //=========================================================================================================
    Hollerith_typespace[CFG] = {
      blank: ' '
    };

    return Hollerith_typespace;

  }).call(this);

  //===========================================================================================================
  _test_monotony = function(x, cmp) {
    var R, chr, chrs, i, idx, prv_chr, ref;
    ({chrs} = this.data); // = @create data
    if (chrs.length === 0) {
      return this.fail("empty is not monotonic");
    }
    if (chrs.length === 1) {
      return true;
    }
    for (idx = i = 1, ref = chrs.length; (1 <= ref ? i < ref : i > ref); idx = 1 <= ref ? ++i : --i) {
      prv_chr = chrs[idx - 1];
      chr = chrs[idx];
      R = (function() {
        switch (cmp) {
          case '>':
            return prv_chr > chr;
          case '<':
            return prv_chr < chr;
          default:
            throw new Error(`Ωbsk___6 (internal) expected '>' or '<', got ${rpr(cmp)}`);
        }
      })();
      if (R) {
        continue;
      }
      this.assign({
        fail: {x, idx, prv_chr, chr}
      });
      return false;
    }
    return true;
  };

  //===========================================================================================================
  Object.assign(module.exports, {
    Hollerith_typespace,
    CFG: CFG,
    internals: {Type, Typespace}
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL3R5cGVzLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQTtFQUFBO0FBQUEsTUFBQSxHQUFBLEVBQUEsbUJBQUEsRUFBQSxTQUFBLEVBQUEsSUFBQSxFQUFBLFNBQUEsRUFBQSxjQUFBLEVBQUEsS0FBQSxFQUFBLE1BQUEsRUFBQSxHQUFBLEVBQUEsT0FBQTs7O0VBR0EsU0FBQSxHQUE0QixPQUFBLENBQVEscUNBQVI7O0VBQzVCLENBQUEsQ0FBRSxPQUFGLENBQUEsR0FBNEIsU0FBUyxDQUFDLFFBQVEsQ0FBQyxlQUFuQixDQUFBLENBQTVCOztFQUNBLENBQUE7SUFBRSxjQUFBLEVBQWdCO0VBQWxCLENBQUEsR0FBNEIsU0FBUyxDQUFDLFFBQVEsQ0FBQyxZQUFuQixDQUFBLENBQTVCOztFQUNBLENBQUEsQ0FBRSxLQUFGLENBQUEsR0FBNEIsT0FBNUIsRUFOQTs7O0VBUUEsQ0FBQSxDQUFFLE1BQUYsQ0FBQSxHQUE0QixNQUE1Qjs7RUFDQSxDQUFBLENBQUUsSUFBRixFQUNFLFNBREYsRUFFRSxHQUZGLENBQUEsR0FFNEIsU0FBUyxDQUFDLFFBQVEsQ0FBQyxpQkFBbkIsQ0FBQSxDQUY1Qjs7RUFTTTs7OztJQUFOLE1BQUEsb0JBQUEsUUFBa0MsVUFBbEMsQ0FBQTs7TUFPbUIsT0FBaEIsSUFBZ0IsQ0FBRSxDQUFGLENBQUE7ZUFBUyxDQUFFLE9BQUEsQ0FBUSxDQUFSLENBQUYsQ0FBQSxLQUFpQjtNQUExQjs7TUFDQSxPQUFoQixhQUFnQixDQUFFLENBQUYsQ0FBQTtlQUFTLENBQUUsSUFBQyxDQUFBLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBUixDQUFZLENBQVosQ0FBRixDQUFBLElBQXNCLENBQUUsQ0FBQyxDQUFDLE1BQUYsR0FBVyxDQUFiO01BQS9COztNQUNBLE9BQWhCLFNBQWdCLENBQUUsQ0FBRixDQUFBO2VBQVMsQ0FBRSxJQUFDLENBQUEsQ0FBQyxDQUFDLElBQUks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QUEsRUFBTSxDQUFFLENBQUYsRUFBSyxHQUFMLEVBQVUsT0FBVixFQUFtQixHQUFuQjtNQUFSLENBQVI7QUFDQSxhQUFPO0lBVFQ7QUFVQSxXQUFPO0VBZFEsRUEvRWpCOzs7RUFnR0EsTUFBTSxDQUFDLE1BQVAsQ0FBYyxNQUFNLENBQUMsT0FBckIsRUFBOEI7SUFDNUIsbUJBRDRCO0lBRTVCLEdBQUEsRUFBc0IsR0FGTTtJQUc1QixTQUFBLEVBQXNCLENBQUUsSUFBRixFQUFRLFNBQVI7RUFITSxDQUE5QjtBQWhHQSIsInNvdXJjZXNDb250ZW50IjpbIlxuJ3VzZSBzdHJpY3QnXG5cbiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuU0ZNT0RVTEVTICAgICAgICAgICAgICAgICA9IHJlcXVpcmUgJy4uLy4uL2JyaWNhYnJhYy1zaW5nbGUtZmlsZS1tb2R1bGVzJ1xueyB0eXBlX29mLCAgICAgICAgICAgICAgfSA9IFNGTU9EVUxFUy51bnN0YWJsZS5yZXF1aXJlX3R5cGVfb2YoKVxueyBzaG93X25vX2NvbG9yczogcnByLCAgfSA9IFNGTU9EVUxFUy51bnN0YWJsZS5yZXF1aXJlX3Nob3coKVxueyBkZWJ1ZywgICAgICAgICAgICAgICAgfSA9IGNvbnNvbGVcbiMgeyByZWdleCwgICAgICAgICAgICAgICAgfSA9IHJlcXVpcmUgJ3JlZ2V4J1xueyBmcmVlemUsICAgICAgICAgICAgICAgfSA9IE9iamVjdFxueyBUeXBlLFxuICBUeXBlc3BhY2UsXG4gIENGRywgICAgICAgICAgICAgICAgICB9ID0gU0ZNT0RVTEVTLnVuc3RhYmxlLnJlcXVpcmVfbmFub3R5cGVzKClcblxuXG5cbiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xuIyBIT0xMRVJJVEggVFlQRVNQQUNFXG4jPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmNsYXNzIEhvbGxlcml0aF90eXBlc3BhY2UgZXh0ZW5kcyBUeXBlc3BhY2VcblxuICAjPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIEBbQ0ZHXTpcbiAgICBibGFuazogJyAnXG5cbiAgIz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBAdGV4dDogICAgICAgICAgICggeCApIC0+ICggdHlwZV9vZiB4ICkgaXMgJ3RleHQnXG4gIEBub25lbXB0eV90ZXh0OiAgKCB4ICkgLT4gKCBAVC50ZXh0LmlzYSB4ICkgYW5kICggeC5sZW5ndGggPiAwIClcbiAgQGNoYXJhY3RlcjogICAgICAoIHggKSAtPiAoIEBULnRleHQuaXNhIHggKSBhbmQgKCAvXi4kL3YudGVzdCB4IClcbiAgQGZsb2F0OiAgICAgICAgICAoIHggKSAtPiBOdW1iZXIuaXNGaW5pdGUgeFxuICBAaW50ZWdlcjogICAgICAgICggeCApIC0+IE51bWJlci5pc1NhZmVJbnRlZ2VyIHhcbiAgQHBpbnRlZ2VyOiAgICAgICAoIHggKSAtPiAoIEBULmludGVnZXIuaXNhIHggKSBhbmQgKCB4ID4gIDAgKVxuICBAenBpbnRlZ2VyOiAgICAgICggeCApIC0+ICggQFQuaW50ZWdlci5pc2EgeCApIGFuZCAoIHggPj0gMCApXG4gIEBjYXJkaW5hbDogICAgICAgKCB4ICkgLT4gQFQuenBpbnRlZ2VyLmlzYSB4XG4gICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgIyMjIE5PVEUgcmVxdWlyaW5nIGB4YCB0byBiZSBib3RoIGEgY2hhcmFjdGVyIGFuZCBlcXVhbCB0byBgQFtDRkddLmJsYW5rYCBtZWFucyBgQFtDRkddLmJsYW5rYCBpdHNlbGYgY2FuIGJlIHRlc3RlZCAjIyNcbiAgQGJsYW5rOiAgICAgICAgICAoIHggKSAtPiAoIEBULmNoYXJhY3Rlci5pc2EgeCApIGFuZCAoIHggaXMgQFtDRkddLmJsYW5rIClcbiAgQGRpbWVuc2lvbjogICAgICAoIHggKSAtPiBAVC5waW50ZWdlci5pc2EgIHhcblxuICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIEBpbmNyZW1lbnRhbF90ZXh0OiAoIHggKSAtPlxuICAgIHJldHVybiBmYWxzZSB1bmxlc3MgQFQudGV4dC5pc2EgeFxuICAgIEBhc3NpZ24geyBjaHJzOiAoIGZyZWV6ZSBBcnJheS5mcm9tIHggKSwgfVxuICAgIHJldHVybiBfdGVzdF9tb25vdG9ueS5jYWxsIEAsIHgsICc8J1xuXG4gICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgQGRlY3JlbWVudGFsX3RleHQ6ICggeCApIC0+XG4gICAgcmV0dXJuIGZhbHNlIHVubGVzcyBAVC50ZXh0LmlzYSB4XG4gICAgQGFzc2lnbiB7IGNocnM6ICggZnJlZXplIEFycmF5LmZyb20geCApLCB9XG4gICAgcmV0dXJuIF90ZXN0X21vbm90b255LmNhbGwgQCwgeCwgJz4nXG5cbiAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBAbm1hZ19iYXJlX3JldmVyc2VkOiAgKCB4ICkgLT4gQFQuaW5jcmVtZW50YWxfdGV4dC5pc2EgeCwgQGRhdGFcbiAgQHBtYWdfYmFyZTogICAgICAgICAgICggeCApIC0+IEBULmluY3JlbWVudGFsX3RleHQuaXNhIHgsIEBkYXRhXG5cbiAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBAbWFnbmlmaWVyczogKCB4ICkgLT5cbiAgICByZXR1cm4gKCBAZmFpbCBcImV4cGVjdGVkIGEgbWFnbmlmaWVyLCBnb3QgYW4gZW1wdHkgdGV4dFwiICkgdW5sZXNzIEBULm5vbmVtcHR5X3RleHQuaXNhIHhcbiAgICBbIG5tYWdfYmFyZV9yZXZlcnNlZCxcbiAgICAgIHBtYWdfYmFyZSwgIF0gPSB4LnNwbGl0IEBbQ0ZHXS5ibGFua1xuICAgICMuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXG4gICAgIyBAYXNzaWduIHsgaWFtOiAnbWFnbmlmaWVycycsIH07IGRlYnVnICfOqWJza19fXzEnLCBAZGF0YVxuICAgIHJldHVybiAoIEBmYWlsIFwizqlic2tfX18yID8/P1wiICkgdW5sZXNzICBAVC5ubWFnX2JhcmVfcmV2ZXJzZWQuaXNhIG5tYWdfYmFyZV9yZXZlcnNlZCwgQGRhdGEsIHsgY2hyczogJ25tYWdfY2hyc19yZXZlcnNlZCcsIH1cbiAgICByZXR1cm4gKCBAZmFpbCBcIs6pYnNrX19fMyA/Pz9cIiApIHVubGVzcyAgQFQucG1hZ19iYXJlLmlzYSAgICAgICAgICBwbWFnX2JhcmUsICAgICAgICAgIEBkYXRhLCB7IGNocnM6ICdwbWFnX2NocnMnLCB9XG4gICAgcmV0dXJuICggQGZhaWwgXCLOqWJza19fXzQgPz8/XCIgKSB1bmxlc3MgIEBULmluY3JlbWVudGFsX3RleHQuaXNhICAgbm1hZ19iYXJlX3JldmVyc2VkICsgcG1hZ19iYXJlXG4gICAgIy4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cbiAgICBubWFnICAgICAgICAgICAgPSBAW0NGR10uYmxhbmsgKyBbIEBkYXRhLm5tYWdfY2hyc19yZXZlcnNlZC4uLiwgXS5yZXZlcnNlKCkuam9pbiAnJ1xuICAgIHBtYWcgICAgICAgICAgICA9IEBbQ0ZHXS5ibGFuayArIHBtYWdfYmFyZVxuICAgIEBhc3NpZ24geyBubWFnLCBwbWFnLCB9XG4gICAgcmV0dXJuIHRydWVcblxuICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIEBhbHBoYWJldDogKCB4ICkgLT5cbiAgICByZXR1cm4gZmFsc2UgdW5sZXNzIEBULmluY3JlbWVudGFsX3RleHQuaXNhIHgsIEBkYXRhLCB7IGNocnM6ICdhbHBoYWJldF9jaHJzJywgfVxuICAgICMgZGVidWcgJ86pYnNrX19fNScsIEBkYXRhXG4gICAgcmV0dXJuIEBmYWlsIFwiYW4gYWxwaGFiZXQgbXVzdCBoYXZlIDIgY2hycyBvciBtb3JlXCIgdW5sZXNzIEBkYXRhLmFscGhhYmV0X2NocnMubGVuZ3RoID49IDJcbiAgICByZXR1cm4gdHJ1ZVxuXG5cbiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuX3Rlc3RfbW9ub3RvbnkgPSAoIHgsIGNtcCApIC0+XG4gIHsgY2hycywgfSA9IEBkYXRhICMgPSBAY3JlYXRlIGRhdGFcbiAgcmV0dXJuICggQGZhaWwgXCJlbXB0eSBpcyBub3QgbW9ub3RvbmljXCIgKSBpZiBjaHJzLmxlbmd0aCBpcyAwXG4gIHJldHVybiB0cnVlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNocnMubGVuZ3RoIGlzIDFcbiAgZm9yIGlkeCBpbiBbIDEgLi4uIGNocnMubGVuZ3RoIF1cbiAgICBwcnZfY2hyID0gY2hyc1sgaWR4IC0gMSBdXG4gICAgY2hyICAgICA9IGNocnNbIGlkeCAgICAgXVxuICAgIFIgICAgICAgPSBzd2l0Y2ggY21wXG4gICAgICB3aGVuICc+JyB0aGVuIHBydl9jaHIgPiBjaHJcbiAgICAgIHdoZW4gJzwnIHRoZW4gcHJ2X2NociA8IGNoclxuICAgICAgZWxzZSB0aHJvdyBuZXcgRXJyb3IgXCLOqWJza19fXzYgKGludGVybmFsKSBleHBlY3RlZCAnPicgb3IgJzwnLCBnb3QgI3tycHIgY21wfVwiXG4gICAgY29udGludWUgaWYgUlxuICAgIEBhc3NpZ24geyBmYWlsOiB7IHgsIGlkeCwgcHJ2X2NociwgY2hyLCB9LCB9XG4gICAgcmV0dXJuIGZhbHNlXG4gIHJldHVybiB0cnVlXG5cbiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuT2JqZWN0LmFzc2lnbiBtb2R1bGUuZXhwb3J0cywge1xuICBIb2xsZXJpdGhfdHlwZXNwYWNlLFxuICBDRkc6ICAgICAgICAgICAgICAgICAgQ0ZHLFxuICBpbnRlcm5hbHM6ICAgICAgICAgICAgeyBUeXBlLCBUeXBlc3BhY2UsIH0sIH1cbiJdfQ==
